<!Doctype html>
<html lang="ko">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
<meta name="format-detection" content="telephone=no">
<title>오늘의점심</title>
<style>
</style>
</head>
<body>
<div class="lst"></div>
<div id="map" style="width:500px;height:400px;"></div>

<!-- [D] JS -->
<script type="text/javascript" src="js/lib/jquery.min.js"></script>
<script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=caec3e6b91051bcd8801d48bda0d83d6"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.11/handlebars.min.js"></script>
<script type="text/javascript" src="js/lib/handlebars-helper-x.js"></script>
<!-- <script type="text/javascript" src="js/estate_info.js"></script> -->
<!-- // [D] JS -->
<script>
	var container = document.getElementById('map');
	var options = {
		center: new daum.maps.LatLng(37.4015443, 127.1074713),
		level: 3
	};

	var map = new daum.maps.Map(container, options);

	// 지도 확대 축소를 제어할 수 있는  줌 컨트롤을 생성합니다
	var zoomControl = new daum.maps.ZoomControl();
	map.addControl(zoomControl, daum.maps.ControlPosition.RIGHT);

	var bind = function(arr, template, obj){
		var arrLength = arr.length,
			randomArr = [];
		
		for(var i=0, len=3; i<len; i++){
			randomArr[i] = parseInt(Math.random() * arrLength);
			console.log(randomArr[i])
			for(var j=0; j<i; j++){
				console.log(randomArr[i] + " vs " + randomArr[j])
				if(randomArr[i] === randomArr[j]){
					console.log('equal')
					i--;
					break;
				}
				console.log('not equal')
			}
		}

		var hbs = $.ajax({
			url: 'js/hbs/' + template + '.hbs'
		});
		var hbsThen = function(hbs){
			var template = Handlebars.compile(hbs);
			var target = $(''+obj+'');

			for(var i in randomArr){
				console.log(arr[randomArr[i]])
				var html = template(arr[randomArr[i]]);
				target.append(html);
			}
		}
		hbs.then(hbsThen);

		for(var i=0, len=randomArr.length; i<len; i++){
			console.log(arr[randomArr[i]].ypos + "/" + arr[randomArr[i]].xpos)
			var marker = new daum.maps.Marker({
				map : map,
				position : new daum.maps.LatLng(arr[randomArr[i]].ypos, arr[randomArr[i]].xpos)
			})
			marker.setMap(map);
		}
		// var markers = $(arr).map(function(randomArr[i], position){
		// 	console.log(randomArr[i])
		// 	return new daum.maps.Marker({
		// 		map : map,
		// 		position : new daum.maps.LatLng(position.ypos, position.xpos)
		// 	});
		// })
	}

	$.get('js/data/place.json', function(data){
		bind(data, 'lst', '.lst');

		// var markers = $(data).map(function(i, position) {
		// 	console.log(data[3].xpos)
		// 	return new daum.maps.Marker({
		// 		map : map,
		// 		position : new daum.maps.LatLng(position.ypos, position.xpos)
		// 	});
		// });
	});
</script>
</body>
</html>